<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>PUDiN | Production Calculator</title>
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>
<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
<!-- React & Babel for runtime compilation -->
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
html, body {
height: 100%;
margin: 0;
padding: 0;
background-color: #000000;
color: #ffffff;
overflow: hidden;
overscroll-behavior-y: none;
}
code
Code
body {
        font-family: 'Inter', sans-serif;
        -webkit-tap-highlight-color: transparent;
    }
    
    ::-webkit-scrollbar {
        width: 4px;
    }
    ::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.1);
    }
    ::-webkit-scrollbar-thumb {
        background: #27272a;
        border-radius: 10px;
    }

    .custom-scrollbar {
        scrollbar-width: thin;
        scrollbar-color: #27272a transparent;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }

    select {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23ffffff'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E") !important;
        background-position: right 0.5rem center !important;
        background-repeat: no-repeat !important;
        background-size: 0.9em !important;
        appearance: none;
    }

    /* Drawer Overlay */
    .drawer-overlay {
        background: rgba(0,0,0,0.8);
        backdrop-filter: blur(4px);
        transition: opacity 0.3s ease;
    }

    @media print {
        @page {
            margin: 0;
        }
        
        html, body { 
            height: auto !important; 
            overflow: visible !important; 
            background: white !important; 
            color: black !important;
        }
        
        #root > div { 
            height: auto !important; 
            display: block !important; 
        }
        
        header, aside, .no-print, button, .mobile-toggle, .drawer-overlay, .floating-footer { 
            display: none !important; 
        }
        
        main { 
            padding: 1cm !important; 
            margin: 0 !important; 
            height: auto !important; 
            overflow: visible !important; 
            display: block !important;
            background: white !important;
        }
        
        .printable-area { 
            border: none !important; 
            background: white !important; 
            color: black !important; 
            width: 100% !important; 
            padding: 0 !important;
            box-shadow: none !important;
            margin-top: 0 !important;
        }
        
        .printable-area * { 
            color: black !important; 
            border-color: #ddd !important; 
        }
        
        .print-color-accent {
            color: #e11d48 !important;
        }
        
        .no-print-val {
            display: none !important;
        }
    }
</style>
<script type="importmap">
{
"imports": {
"react/": "https://esm.sh/react@^19.2.3/",
"react": "https://esm.sh/react@^19.2.3"
}
}
</script>
</head>
<body>
<div id="root"></div>
code
Code
<script type="text/babel">
    const { useState, useMemo, useEffect, useCallback } = React;

    const SERVICES = [
        { id: 'voice', name: '–ì–æ–ª–æ—Å', basePrice: 3000, icon: 'üé§' },
        { id: 'song', name: '–ü–µ—Å–Ω—è', basePrice: 15000, icon: 'üéµ' },
        { id: 'song_light', name: '–ü–µ—Å–Ω—è –ª–∞–π—Ç', basePrice: 6000, icon: '‚ú®' }, // –ù–æ–≤–æ–µ
        { id: 'moment', name: '–ú–æ–º–µ–Ω—Ç', basePrice: 8000, icon: '‚ö°' },       // –¶–µ–Ω–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
        { id: 'history', name: '–ò—Å—Ç–æ—Ä–∏—è', basePrice: 25000, icon: 'üé¨' },
        { id: 'memory', name: '–ü–∞–º—è—Ç—å', basePrice: 7000, icon: 'üéûÔ∏è' },       // –¶–µ–Ω–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
        { id: 'clip', name: '–ö–ª–∏–ø', basePrice: 12000, icon: 'üé•' },
        { id: 'letter', name: '–í–∏–¥–µ–æ-–ø–∏—Å—å–º–æ', basePrice: 12000, icon: '‚úâÔ∏è' }, // –ù–æ–≤–æ–µ
        { id: 'ad', name: '–†–µ–∫–ª–∞–º–∞', basePrice: 15000, icon: 'üì¢' },         // –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ –∏–∑ ad_plus, —Ü–µ–Ω–∞ 15–∫
    ];
    
    const URGENCY_MODIFIER = {
        id: 'urgency',
        name: '–°–∫–æ—Ä–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è',
        options: [
            { label: '–û–±—ã—á–Ω–∞—è', percent: 0, multiplier: 1.0 },
            { label: '–°–∂–∞—Ç–∞—è', percent: 0, multiplier: 1.2 },
            { label: '–°—Ä–æ—á–Ω–∞—è', percent: 0, multiplier: 1.4 },
            { label: '–ì–æ—Ä—è—â–∞—è', percent: 0, multiplier: 1.7 },
        ]
    };

    const DISCOUNT_MODIFIER = {
        id: 'repeat',
        name: '–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–∫–∞–∑',
        options: [
            { label: '–ù–µ—Ç', percent: 0 },
            { label: '–î–∞', percent: -0.15 },
        ]
    };

    const SERVICE_MODIFIERS = {
        voice: ['tracks', 'processing', 'revisions'],
        song: ['has_lyrics', 'tracks', 'processing', 'revisions'],
        song_light: ['has_lyrics', 'tracks', 'processing', 'revisions'],
        moment: ['duration', 'editing', 'color', 'sound_design', 'graphics', 'locations', 'shooting_time', 'pre_production', 'revisions'],
        history: ['duration', 'editing', 'color', 'sound_design', 'pre_production', 'graphics', 'locations', 'shooting_time', 'revisions'],
        memory: ['duration', 'people', 'editing', 'graphics', 'sound_design', 'locations', 'shooting_time', 'color', 'pre_production', 'revisions'],
        clip: ['duration', 'people', 'editing', 'graphics', 'sound_design', 'locations', 'shooting_time', 'color', 'pre_production', 'revisions'],
        letter: ['duration', 'people', 'editing', 'graphics', 'sound_design', 'locations', 'shooting_time', 'color', 'revisions'], // Removed pre_production
        ad: ['duration', 'people', 'graphics', 'sound_design', 'locations', 'shooting_time', 'revisions'], 
    };
    
    const ALL_MODIFIER_GROUPS = [
        {
            id: 'has_lyrics',
            name: '–ï—Å—Ç—å —Ç–µ–∫—Å—Ç',
            options: [
                { label: '–ù–µ—Ç', percent: 0 },
                { label: '–î–∞', percent: -0.15 },
            ]
        },
        {
            id: 'duration',
            name: '–•—Ä–æ–Ω–æ–º–µ—Ç—Ä–∞–∂',
            options: [
                { label: '–°—Ç–∞–Ω–¥–∞—Ä—Ç', percent: 0 },
                { label: '+1 –º–∏–Ω—É—Ç–∞', percent: 0.1 },
                { label: '+2 –º–∏–Ω—É—Ç—ã', percent: 0.15 },
                { label: '+3 –º–∏–Ω—É—Ç—ã', percent: 0.25 },
                { label: '+–ë–æ–ª–µ–µ 3—Ö –º–∏–Ω—É—Ç', percent: 0.3 },
            ]
        },
        {
            id: 'people',
            name: '–ö–æ–ª-–≤–æ —á–µ–ª–æ–≤–µ–∫',
            options: [
                { label: '1 —á–µ–ª–æ–≤–µ–∫', percent: 0 },
                { label: '2-5 —á–µ–ª–æ–≤–µ–∫', percent: 0 },
                { label: '6-10 —á–µ–ª–æ–≤–µ–∫', percent: 0.20 },
                { label: '11-20 —á–µ–ª–æ–≤–µ–∫', percent: 0.30 },
                { label: '21 –∏ –±–æ–ª–µ–µ', percent: 0.40 },
            ]
        },
        {
            id: 'editing',
            name: '–ú–æ–Ω—Ç–∞–∂',
            options: [
                { label: '–ë–∞–∑–æ–≤—ã–π –º–æ–Ω—Ç–∞–∂', percent: 0 },
                { label: '–°–ª–æ–∂–Ω—ã–π –º–æ–Ω—Ç–∞–∂', percent: 0.30 },
            ]
        },
        {
            id: 'graphics',
            name: '–ì—Ä–∞—Ñ–∏–∫–∞',
            options: [
                { label: '–ë–µ–∑ –≥—Ä–∞—Ñ–∏–∫–∏', percent: 0 },
                { label: '–ë–∞–∑–æ–≤–∞—è –≥—Ä–∞—Ñ–∏–∫–∞', percent: 0.10 },
                { label: '–°–ª–æ–∂–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞', percent: 0.30 },
            ]
        },
        {
            id: 'sound_design',
            name: '–°–∞—É–Ω–¥-–¥–∏–∑–∞–π–Ω',
            options: [
                { label: '–ë–µ–∑ —Å–∞—É–Ω–¥-–¥–∏–∑–∞–π–Ω–∞', percent: 0 },
                { label: '–ë–∞–∑–æ–≤—ã–π —Å–∞—É–Ω–¥-–¥–∏–∑–∞–π–Ω', percent: 0.10 },
                { label: '–°–ª–æ–∂–Ω—ã–π —Å–∞—É–Ω–¥-–¥–∏–∑–∞–π–Ω', percent: 0.30 },
            ]
        },
        {
            id: 'locations',
            name: '–õ–æ–∫–∞—Ü–∏–∏',
            options: [
                { label: '–ë–µ–∑ –¥–æ–ø. –ª–æ–∫–∞—Ü–∏–π', percent: 0 },
                { label: '+1 –ª–æ–∫–∞—Ü–∏—è', percent: 0.10 },
                { label: '+2 –ª–æ–∫–∞—Ü–∏–∏', percent: 0.15 },
                { label: '+3 –ª–æ–∫–∞—Ü–∏–∏', percent: 0.20 },
                { label: '+–ë–æ–ª–µ–µ 3—Ö –ª–æ–∫–∞—Ü–∏–π', percent: 0.40 },
            ]
        },
        {
            id: 'shooting_time',
            name: '–í—Ä–µ–º—è —Å—ä–µ–º–∫–∏',
            options: [
                { label: '–°—Ç–∞–Ω–¥–∞—Ä—Ç', percent: 0 },
                { label: '+1 —á–∞—Å', percent: 0.05 },
                { label: '+2 —á–∞—Å–∞', percent: 0.10 },
                { label: '+3 —á–∞—Å–∞', percent: 0.15 },
                { label: '+4 —á–∞—Å–∞', percent: 0.20 },
                { label: '+5 —á–∞—Å–æ–≤', percent: 0.25 },
                { label: '+–ë–æ–ª–µ–µ 6 —á–∞—Å–æ–≤', percent: 0.50 },
            ]
        },
        {
            id: 'color',
            name: '–¶–≤–µ—Ç',
            options: [
                { label: '–ë–∞–∑–æ–≤—ã–π —Ü–≤–µ—Ç', percent: 0 },
                { label: '–†–∞–±–æ—Ç–∞ —Å —Ü–≤–µ—Ç–æ–º', percent: 0.15 },
            ]
        },
        {
            id: 'pre_production',
            name: '–ü—Ä–µ –ø—Ä–æ–¥–∞–∫—à–Ω',
            options: [
                { label: '–ë–µ–∑ –ø—Ä–µ-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞', percent: 0 },
                { label: '–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ —Å—é–∂–µ—Ç', percent: 0.35 },
            ]
        },
        {
            id: 'tracks',
            name: '–í–æ–∫–∞–ª—å–Ω—ã–µ –¥–æ—Ä–æ–∂–∫–∏',
            options: [
                { label: '+–°—Ç–∞–Ω–¥–∞—Ä—Ç', percent: 0 },
                { label: '+1 –¥–æ—Ä–æ–∂–∫–∞', percent: 0.10 },
                { label: '+2 –¥–æ—Ä–æ–∂–∫–∏', percent: 0.15 },
                { label: '+3 –¥–æ—Ä–æ–∂–∫–∏', percent: 0.20 },
                { label: '+4 –¥–æ—Ä–æ–∂–∫–∏', percent: 0.25 },
                { label: '+–ë–æ–ª–µ–µ 5 –¥–æ—Ä–æ–∂–µ–∫', percent: 0.40 },
            ]
        },
        {
            id: 'processing',
            name: '–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏',
            options: [
                { label: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è', percent: 0 },
                { label: '–°–ª–æ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞', percent: 0.30 },
            ]
        },
        {
            id: 'revisions',
            name: '–ü—Ä–∞–≤–∫–∏',
            options: [
                { label: '–ë–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–æ–∫', percent: 0 },
                { label: '+1 –ø—Ä–∞–≤–∫–∞', percent: 0.10 },
                { label: '+2 –ø—Ä–∞–≤–∫–∏', percent: 0.15 },
                { label: '+3 –ø—Ä–∞–≤–∫–∏', percent: 0.20 },
                { label: '+–ë–æ–ª–µ–µ 3—Ö –ø—Ä–∞–≤–æ–∫', percent: 0.40 },
            ]
        }
    ];

    const PriceBreakdownDiagram = ({ service, activeModifiers, urgency, urgencyIdx, intermediateTotal, finalPrice }) => {
        const getUrgencyColor = (idx) => ["#10b981", "#fbbf24", "#f97316", "#ef4444"][idx] || "#10b981";

        return (
            <div className="mt-4 bg-zinc-900/40 border border-white/5 rounded-2xl p-5 md:p-8 printable-area shadow-xl print:p-0 print:bg-transparent print:border-none">
                <div className="hidden print:block mb-4 border-b-2 border-black pb-4">
                    <h1 className="text-2xl font-black uppercase tracking-tighter text-black">–°–º–µ—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞</h1>
                </div>

                <div className="space-y-4 md:space-y-6 print:space-y-3">
                    <div className="flex items-center justify-between">
                        <div className="flex items-center gap-3 md:gap-6 print:gap-4">
                            <div className="w-10 h-10 md:w-14 md:h-14 bg-white text-black flex items-center justify-center rounded-xl md:rounded-2xl text-xl md:text-3xl print:hidden shadow-lg">{service.icon}</div>
                            <span className="text-sm md:text-2xl font-black uppercase tracking-wide print:text-lg print:text-black">{service.name} <span className="hidden md:inline text-zinc-500 font-bold ml-2">(–ë–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞)</span></span>
                        </div>
                        <span className="text-lg md:text-3xl font-mono font-bold print:text-xl print:text-black">{service.basePrice.toLocaleString()} ‚ÇΩ</span>
                    </div>

                    {activeModifiers.length > 0 && (
                        <div className="pl-6 md:pl-20 space-y-2 md:space-y-4 border-l-2 md:border-l-4 border-white/5 print:border-zinc-200 print:pl-8 print:space-y-1">
                            <div className="text-red-600 font-black uppercase tracking-[0.2em] text-[10px] md:text-base print:text-red-600 mb-2 md:mb-4">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏</div>
                            {activeModifiers.map((mod, idx) => {
                                const rubChange = service.basePrice * mod.opt.percent;
                                return (
                                    <div key={idx} className="flex justify-between items-center group">
                                        <div className="text-[11px] md:text-xl text-zinc-400 font-medium group-hover:text-white transition-colors print:text-sm print:text-zinc-700 leading-tight">
                                            {mod.name}: <span className="text-white print:text-black font-bold">{mod.opt.label}</span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <span className="no-print-val text-[10px] md:text-sm text-zinc-500 font-bold mr-1">
                                                ({rubChange > 0 ? '+' : ''}{Math.round(rubChange).toLocaleString()} ‚ÇΩ)
                                            </span>
                                            <span className={`text-[10px] md:text-base font-black px-1.5 py-0.5 md:px-4 md:py-2 rounded-lg md:rounded-xl print:px-0 print:py-0 print:bg-transparent print:text-xs ${mod.opt.percent > 0 ? 'bg-red-950/50 text-red-500 print:text-red-600' : 'bg-emerald-950/50 text-emerald-500 print:text-emerald-600'}`}>
                                                {mod.opt.percent > 0 ? '+' : ''}{Math.round(mod.opt.percent * 100)}%
                                            </span>
                                        </div>
                                    </div>
                                );
                            })}
                            <div className="pt-3 md:pt-6 flex justify-between items-center border-t border-white/5 print:border-zinc-100 print:pt-2 mt-2 md:mt-4">
                                <span className="text-[9px] md:text-sm font-black uppercase tracking-widest text-zinc-500 print:text-[10px] print:text-zinc-400">–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –∏—Ç–æ–≥</span>
                                <span className="text-sm md:text-2xl font-bold text-zinc-200 print:text-lg print:text-zinc-800">{Math.round(intermediateTotal).toLocaleString()} ‚ÇΩ</span>
                            </div>
                        </div>
                    )}

                    <div className="flex items-center justify-between">
                        <div className="flex items-center gap-3 md:gap-6 print:gap-4">
                            <div className="w-10 h-10 md:w-14 md:h-14 border-2 flex items-center justify-center rounded-xl md:rounded-2xl text-[10px] md:text-base font-black print:hidden" style={{borderColor: getUrgencyColor(urgencyIdx), color: getUrgencyColor(urgencyIdx)}}>T!</div>
                            <span className="text-sm md:text-2xl font-black uppercase tracking-wide print:text-lg print:text-black">–°–∫–æ—Ä–æ—Å—Ç—å: <span style={{color: getUrgencyColor(urgencyIdx)}} className="ml-1 md:ml-2 font-black">{urgency.label}</span></span>
                        </div>
                        <span className="text-lg md:text-3xl font-mono font-bold print:text-xl" style={{color: getUrgencyColor(urgencyIdx)}}>√ó{urgency.multiplier}</span>
                    </div>

                    <div className="pt-4 md:pt-8 mt-4 md:mt-6 border-t-[4px] md:border-t-[8px] border-white print:border-black print:pt-4 print:mt-2 print:border-t-4">
                        <div className="flex justify-between items-end">
                            <div className="space-y-1 md:space-y-2 print:space-y-0">
                                <span className="block text-[10px] md:text-base font-black uppercase tracking-[0.2em] md:tracking-[0.5em] text-red-600 print:text-xs print:tracking-[0.3em]">–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ</span>
                            </div>
                            <div className="text-3xl md:text-8xl font-black tracking-tighter leading-none print:text-4xl print:text-black">
                                {finalPrice.toLocaleString()} 
                                <span className="text-lg md:text-4xl text-zinc-600 font-bold ml-1 md:ml-2 print:text-xl print:text-zinc-400">‚ÇΩ</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        );
    };

    const App = () => {
        const [selectedService, setSelectedService] = useState(SERVICES[1]);
        const [selections, setSelections] = useState({});
        const [urgencyIdx, setUrgencyIdx] = useState(0);
        const [repeatIdx, setRepeatIdx] = useState(0);
        const [isSidebarOpen, setIsSidebarOpen] = useState(false);

        useEffect(() => { setSelections({}); }, [selectedService]);

        const applicableGroups = useMemo(() => {
            const allowedIds = SERVICE_MODIFIERS[selectedService.id] || [];
            return ALL_MODIFIER_GROUPS
            .filter(g => allowedIds.includes(g.id))
            .map(group => {
                let options = [...group.options];
                const sid = selectedService.id;
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–µ–∫—Å—Ç –¥–ª—è "–ü–µ—Å–Ω–∏ –ª–∞–π—Ç"
                if (sid === 'song_light' && group.id === 'has_lyrics') {
                    options = [
                        { label: '–ù–µ—Ç', percent: 0 },
                        { label: '–î–∞', percent: -0.10 },
                    ];
                }

                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ (0% –∑–∞ –≤–∫–ª—é—á–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏)
                if (sid === 'history' || sid === 'clip' || sid === 'letter' || sid === 'moment') {
                    if (group.id === 'sound_design') {
                        options = [
                            { label: sid === 'moment' ? '–ë–∞–∑–æ–≤—ã–π —Å–∞—É–Ω–¥-–¥–∏–∑–∞–π–Ω / –º—É–∑—ã–∫–∞' : '–ë–∞–∑–æ–≤—ã–π —Å–∞—É–Ω–¥-–¥–∏–∑–∞–π–Ω', percent: 0 },
                            { label: '–°–ª–æ–∂–Ω—ã–π —Å–∞—É–Ω–¥-–¥–∏–∑–∞–π–Ω', percent: 0.30 },
                        ];
                    }
                }

                if (sid === 'history') {
                    if (group.id === 'pre_production') {
                        options = [
                            { label: '–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞', percent: 0 },
                            { label: '–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ —Å—é–∂–µ—Ç (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π)', percent: 0.35 },
                        ];
                    }
                }

                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –æ–ø—Ü–∏–π –¥–ª—è —É—Å–ª—É–≥
                if (sid === 'memory') {
                    if (group.id === 'people') options = [
                        { label: '–°—Ç–∞–Ω–¥–∞—Ä—Ç', percent: 0 },
                        { label: '1 —á–µ–ª–æ–≤–µ–∫', percent: 0.05 },
                        { label: '2-5 —á–µ–ª–æ–≤–µ–∫', percent: 0.10 },
                        { label: '6-10 —á–µ–ª–æ–≤–µ–∫', percent: 0.20 },
                        { label: '11-20 —á–µ–ª–æ–≤–µ–∫', percent: 0.30 },
                        { label: '21 –∏ –±–æ–ª–µ–µ', percent: 0.40 },
                    ];
                }
                
                // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—Å–ª—É–≥–∏ —Å–æ —Å—Ö–æ–∂–µ–π –ª–æ–≥–∏–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏ –ø–æ –ª—é–¥—è–º (–ö–ª–∏–ø, –ü–∏—Å—å–º–æ, –†–µ–∫–ª–∞–º–∞)
                if (sid === 'clip' || sid === 'letter' || sid === 'ad') {
                    if (group.id === 'people') options = [
                        { label: '1 —á–µ–ª–æ–≤–µ–∫', percent: 0 },
                        { label: '2-5 —á–µ–ª–æ–≤–µ–∫', percent: 0.10 },
                        { label: '6-10 —á–µ–ª–æ–≤–µ–∫', percent: 0.20 },
                        { label: '11-20 —á–µ–ª–æ–≤–µ–∫', percent: 0.30 },
                        { label: '21 –∏ –±–æ–ª–µ–µ', percent: 0.40 },
                    ];
                }
                
                // –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –ö–ª–∏–ø–∞ –∏ –í–∏–¥–µ–æ-–ø–∏—Å—å–º–∞
                if ((sid === 'clip' || sid === 'letter') && group.id === 'graphics') {
                    options = [
                        { label: '–ë–∞–∑–æ–≤–∞—è –≥—Ä–∞—Ñ–∏–∫–∞', percent: 0 },
                        { label: '–°–ª–æ–∂–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞', percent: 0.30 },
                    ];
                }
                
                // –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ —Å–∞—É–Ω–¥-–¥–∏–∑–∞–π–Ω–∞ –¥–ª—è –†–µ–∫–ª–∞–º—ã (–±—ã–≤—à–∞—è ad_plus)
                if (sid === 'ad' && group.id === 'sound_design') {
                    options = [
                        { label: '–ë–∞–∑–æ–≤—ã–π —Å–∞—É–Ω–¥-–¥–∏–∑–∞–π–Ω', percent: 0 },
                        { label: '–°–ª–æ–∂–Ω—ã–π —Å–∞—É–Ω–¥-–¥–∏–∑–∞–π–Ω', percent: 0.30 },
                    ];
                }
                
                return { ...group, options };
            });
        }, [selectedService]);
        
        const { finalPrice, activeModifiers, intermediateTotal } = useMemo(() => {
            const base = selectedService.basePrice;
            const active = [];
            let totalModifiersPercent = 0;

            applicableGroups.forEach(group => {
                const selectedIdx = selections[group.id] || 0;
                const opt = group.options[selectedIdx];
                if (opt && opt.percent !== 0) {
                    active.push({ name: group.name, opt });
                    totalModifiersPercent += opt.percent;
                }
            });

            const discountOpt = DISCOUNT_MODIFIER.options[repeatIdx];
            if (discountOpt.percent !== 0) {
                active.push({ name: DISCOUNT_MODIFIER.name, opt: discountOpt });
                totalModifiersPercent += discountOpt.percent;
            }

            const interTotal = base * (1 + totalModifiersPercent);
            const urgencyOpt = URGENCY_MODIFIER.options[urgencyIdx];
            const final = Math.round(interTotal * (urgencyOpt.multiplier || 1.0));

            return { finalPrice: final, activeModifiers: active, intermediateTotal: interTotal };
        }, [selectedService, applicableGroups, selections, urgencyIdx, repeatIdx]);

        const copyToClipboard = () => {
            const text = `–ü—Ä–æ–µ–∫—Ç: ${selectedService.name}\n–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:\n${activeModifiers.map(m => `- ${m.name}: ${m.opt.label}`).join('\n')}\n–°–∫–æ—Ä–æ—Å—Ç—å: ${URGENCY_MODIFIER.options[urgencyIdx].label}\n–ò–¢–û–ì–û: ${finalPrice.toLocaleString()} ‚ÇΩ`;
            navigator.clipboard.writeText(text);
            alert('–†–∞—Å—á–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
        };

        return (
            <div className="h-screen bg-black text-white flex flex-col selection:bg-red-600 selection:text-white overflow-hidden">
                {/* Header */}
                <header className="h-14 md:h-20 border-b border-white/10 flex items-center justify-between px-4 md:px-12 bg-black shrink-0 sticky top-0 z-50 no-print">
                    <div className="flex items-center gap-3 md:gap-8">
                        <button 
                            onClick={() => setIsSidebarOpen(true)}
                            className="lg:hidden p-2 -ml-2 text-white bg-zinc-900/50 rounded-lg active:scale-95 transition-transform"
                        >
                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                        </button>
                        <div className="text-xl md:text-3xl font-black tracking-tighter">PUD<span className="text-red-600">i</span>N</div>
                        <div className="hidden md:block h-8 w-px bg-white/20 mx-4"></div>
                        <div className="hidden md:block text-[10px] md:text-xs font-black uppercase tracking-[0.5em] text-zinc-500">Production Workflow</div>
                    </div>
                    <div className="flex items-center gap-2">
                         <div className="hidden sm:block text-[10px] font-black uppercase text-zinc-500 bg-zinc-900 px-3 py-1 rounded-full border border-white/5">{selectedService.name}</div>
                         <button onClick={() => setIsSidebarOpen(true)} className="lg:hidden text-[9px] font-black uppercase text-white bg-red-600 px-3 py-1.5 rounded-full active:scale-95 shadow-lg shadow-red-600/20">–£—Å–ª—É–≥–∏</button>
                    </div>
                </header>

                <div className="flex flex-1 overflow-hidden relative">
                    {/* Sidebar Drawer */}
                    {isSidebarOpen && (
                        <div 
                            className="lg:hidden fixed inset-0 z-[60] drawer-overlay"
                            onClick={() => setIsSidebarOpen(false)}
                        />
                    )}
                    <aside className={`
                        ${isSidebarOpen ? 'translate-x-0 shadow-2xl shadow-black' : '-translate-x-full'} lg:translate-x-0
                        fixed lg:relative inset-y-0 left-0 z-[70] lg:z-10
                        w-[80%] max-w-[300px] lg:w-[320px] border-r border-white/5 bg-zinc-950 p-5 flex flex-col gap-3 no-print custom-scrollbar transition-transform duration-300 ease-in-out
                    `}>
                        <div className="flex items-center justify-between lg:block mb-4">
                            <div className="text-[10px] font-black uppercase tracking-[0.2em] text-zinc-600 px-2 shrink-0">–í—ã–±–æ—Ä —É—Å–ª—É–≥–∏</div>
                            <button onClick={() => setIsSidebarOpen(false)} className="lg:hidden p-2 text-zinc-500"><svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
                        </div>
                        <div className="flex flex-col gap-2">
                            {SERVICES.map((s) => (
                                <button key={s.id} onClick={() => { setSelectedService(s); setIsSidebarOpen(false); }}
                                    className={`w-full flex items-center gap-4 p-3.5 rounded-xl md:rounded-2xl transition-all text-left ${selectedService.id === s.id ? 'bg-white text-black scale-[1.02] shadow-xl' : 'hover:bg-zinc-900 text-zinc-500 hover:text-white'}`}
                                >
                                    <span className="text-2xl">{s.icon}</span>
                                    <div className="overflow-hidden">
                                        <span className="block text-sm md:text-base font-black uppercase truncate leading-tight">{s.name}</span>
                                        <span className={`text-[10px] font-bold font-mono ${selectedService.id === s.id ? 'text-zinc-600' : 'text-zinc-800'}`}>{s.basePrice.toLocaleString()} ‚ÇΩ</span>
                                    </div>
                                </button>
                            ))}
                        </div>
                        <div className="mt-auto pt-6 border-t border-white/5 text-[9px] text-zinc-700 font-bold uppercase tracking-widest text-center italic">v3.0 Production Tool</div>
                    </aside>

                    <main className="flex-1 p-4 md:p-8 flex flex-col gap-5 md:gap-8 bg-[#030303] custom-scrollbar pb-36">
                        <section className="no-print shrink-0">
                            <h2 className="text-lg md:text-3xl font-black uppercase tracking-tight mb-4 flex items-center gap-3">
                                <span className="w-1.5 h-6 bg-red-600 rounded-full"></span>
                                {selectedService.name}
                            </h2>
                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-2.5 md:gap-4">
                                {applicableGroups.map((group) => (
                                    <div key={group.id} className="bg-zinc-900/30 p-2 md:p-0 rounded-xl">
                                        <label className="block text-[9px] md:text-xs font-black uppercase text-zinc-600 mb-1 tracking-[0.1em] px-1">{group.name}</label>
                                        <select value={selections[group.id] || 0} onChange={(e) => setSelections(prev => ({ ...prev, [group.id]: parseInt(e.target.value) }))}
                                            className="w-full bg-zinc-900 border border-zinc-800 p-2 md:p-3 text-xs md:text-lg font-bold uppercase rounded-lg md:rounded-xl appearance-none focus:outline-none focus:border-red-600 transition-all shadow-md"
                                        >
                                            {group.options.map((opt, idx) => {
                                                const rub = selectedService.basePrice * opt.percent;
                                                const rLabel = opt.percent !== 0 ? ` [${rub > 0 ? '+' : ''}${Math.round(rub).toLocaleString()} ‚ÇΩ]` : '';
                                                return (
                                                    <option key={idx} value={idx}>
                                                        {opt.label} ({opt.percent > 0 ? `+${Math.round(opt.percent * 100)}%` : opt.percent < 0 ? `${Math.round(opt.percent * 100)}%` : '0%'}){rLabel}
                                                    </option>
                                                );
                                            })}
                                        </select>
                                    </div>
                                ))}
                            </div>
                        </section>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-5 md:gap-10 pt-4 border-t border-white/5 no-print shrink-0">
                            <section>
                                <h3 className="text-[9px] md:text-[11px] font-black uppercase tracking-[0.2em] text-zinc-600 mb-2 md:mb-4">–°–∫–æ—Ä–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
                                <div className="grid grid-cols-4 gap-1.5 md:gap-3">
                                    {URGENCY_MODIFIER.options.map((opt, idx) => (
                                        <button key={idx} onClick={() => setUrgencyIdx(idx)}
                                            className={`p-2 md:p-4 border-2 transition-all rounded-lg md:rounded-2xl text-center flex flex-col items-center justify-center ${urgencyIdx === idx ? 'border-white bg-white text-black shadow-lg scale-[1.02]' : 'border-zinc-800 text-zinc-500 hover:border-zinc-600'}`}
                                        >
                                            <div className="text-[7px] md:text-[10px] font-black uppercase mb-0.5">{opt.label}</div>
                                            <div className="text-[11px] md:text-xl font-black italic">x{opt.multiplier || '1.0'}</div>
                                        </button>
                                    ))}
                                </div>
                            </section>
                            <section>
                                <h3 className="text-[9px] md:text-[11px] font-black uppercase tracking-[0.2em] text-zinc-600 mb-2 md:mb-4">–õ–æ—è–ª—å–Ω–æ—Å—Ç—å</h3>
                                <div className="flex gap-2 md:gap-3">
                                    {DISCOUNT_MODIFIER.options.map((opt, idx) => {
                                        const rub = selectedService.basePrice * opt.percent;
                                        return (
                                            <button key={idx} onClick={() => setRepeatIdx(idx)}
                                                className={`flex-1 p-2 md:p-4 border-2 transition-all rounded-lg md:rounded-2xl font-black uppercase text-[9px] md:text-sm ${repeatIdx === idx ? 'border-emerald-500 bg-emerald-500 text-black shadow-lg scale-[1.02]' : 'border-zinc-800 text-zinc-600'}`}
                                            >
                                                {opt.label === '–î–∞' ? '–ü–æ–≤—Ç–æ—Ä–Ω—ã–π' : '–ü–µ—Ä–≤–∏—á–Ω—ã–π'}
                                                <div className="mt-0.5 text-[10px] md:text-lg font-mono">{opt.percent < 0 ? '-15%' : '0%'}</div>
                                                {opt.percent !== 0 && <div className="text-[8px] md:text-xs opacity-60 font-mono no-print-val">{Math.round(rub).toLocaleString()} ‚ÇΩ</div>}
                                            </button>
                                        );
                                    })}
                                </div>
                            </section>
                        </div>

                        <div className="shrink-0">
                            <PriceBreakdownDiagram service={selectedService} activeModifiers={activeModifiers} urgency={URGENCY_MODIFIER.options[urgencyIdx]} urgencyIdx={urgencyIdx} intermediateTotal={intermediateTotal} finalPrice={finalPrice} />
                        </div>
                    </main>
                </div>

                {/* Floating Action Bar (Always visible) */}
                <div className="fixed bottom-0 left-0 right-0 bg-zinc-950/90 backdrop-blur-xl border-t border-white/10 p-4 pb-6 md:pb-4 flex items-center justify-between no-print z-50 floating-footer">
                    <div className="flex flex-col">
                        <span className="text-[8px] md:text-[10px] font-black uppercase text-zinc-600 tracking-[0.2em]">–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ</span>
                        <span className="text-xl md:text-3xl font-black tabular-nums">{finalPrice.toLocaleString()} <span className="text-xs md:text-sm font-bold text-zinc-600">‚ÇΩ</span></span>
                    </div>
                    <div className="flex gap-2 md:gap-4">
                        <button onClick={copyToClipboard} title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—á–µ—Ç" className="bg-zinc-900 text-white p-3 md:p-4 rounded-xl border border-white/10 active:scale-95 transition-transform hover:bg-zinc-800">
                            <svg className="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg>
                        </button>
                        <button onClick={() => window.print()} className="bg-red-600 text-white px-5 md:px-8 py-3 md:py-4 rounded-xl font-black uppercase text-[10px] md:text-xs tracking-widest active:scale-95 shadow-xl shadow-red-600/30 hover:bg-red-700 transition-colors">–ü–µ—á–∞—Ç—å PDF</button>
                    </div>
                </div>
            </div>
        );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>
</body>
</html>